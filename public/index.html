<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To do list</title>
    <link rel="shortcut icon" href="https://www.flaticon.com/svg/static/icons/svg/1617/1617614.svg" type="image/x-icon" >

    <link rel="stylesheet" type="text/css" href="stylesheets/todo.css">
  </head>

<body onload="loadList()">

<h1>To do</h1>

<ol id="list">

</ol>

<button id="addItem" onclick="addItem()">Create a new todo item</button>
<form id="todo" method="GET" action="/update">
  
  <table class="hidden" id="addForm">
    <tr><td>To do item</td><td><input type="text" name="item"></td></tr>
    <tr><td>Item priority</td><td class="hint"><input type="number" name="priority" min="1" max="3">1 = high, 3 = low</td></tr>
    <tr><td colspan="2"><input type="submit" value="Update list" ><input type="button" onclick="cancel()" value="Cancel"></td></tr>
  </table>
</form>


<script>
  function loadList() { 
    var xmlHttpRequest = new XMLHttpRequest();
    xmlHttpRequest.onreadystatechange = function() { 
      if (xmlHttpRequest.readyState == XMLHttpRequest.DONE && xmlHttpRequest.status == 200 ) {
        console.log('getting database request');

        var database = JSON.parse(xmlHttpRequest.responseText);
        console.log(database);
        var list = document.getElementById('list');

        for (var i = 0; i < database.todo.length; i++) { 
          var item = document.createElement('li');
          item.innerHTML = database.todo[i].item;
          list.appendChild(item);
        }

      }
    }
    xmlHttpRequest.open('GET', 'https://nates-notes.herokuapp.com/todo', true);
    xmlHttpRequest.send();
  };

  function addItem() { 
    document.getElementById('addForm').style.display = "initial";
    document.getElementById('addItem').style.display = "none";
  };

  function cancel() { 
    document.getElementById('addForm').style.display = "none";
    document.getElementById('addItem').style.display = "initial";
  }
</script>


</body>
</html>